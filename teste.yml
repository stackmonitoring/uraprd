docker network create \
  --driver overlay \
  portainer_agent_network;

docker service create \
  --name portainer_edge_agent \
  --network portainer_agent_network \
  -e AGENT_CLUSTER_ADDR=tasks.portainer_edge_agent \
  -e EDGE=1 \
  -e EDGE_ID=598f276a-a563-4e58-ab04-7432f5229bb6 \
  -e EDGE_KEY=aHR0cDovLzE5Mi4xNjguMjI1LjYzOjkwMDB8MTkyLjE2OC4yMjUuNjM6ODAwMHw0YTo3YzpkNDpkODpkYzo0Mzo3Njo1ZDozNTphZjoyZjplNzo5YjphMzo1NDpiMHw0 \
  -e CAP_HOST_MANAGEMENT=1 \
  --mode global \
  --constraint 'node.platform.os == linux' \
  --mount type=bind,src=//var/run/docker.sock,dst=/var/run/docker.sock \
  --mount type=bind,src=//var/lib/docker/volumes,dst=/var/lib/docker/volumes \
  --mount type=bind,src=//,dst=/host \
  --mount type=volume,src=portainer_agent_data,dst=/data \
  portainer/agent
